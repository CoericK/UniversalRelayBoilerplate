{"version":3,"sources":["../../../../units/urb-account-management-webapp/components/LogoutScreen.jsx"],"names":["styles","theme","card","minWidth","LogoutScreen","Component","constructor","props","context","_handle_onClick_Logout","setState","currentOperation","loc","window","location","host","protocol","hostname","port","response","fetch","method","credentials","headers","body","responseData","json","console","log","success","errorMessage","error","err","message","_handle_onClick_CancelLogout","_handle_onClick_TryAgain","_handle_onClick_Continue","replace","state","renderCreating","classes","renderSuccess","renderFailure","renderPrompt","render"],"mappings":"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","file":"LogoutScreen.js","sourcesContent":["// @flow\n\nimport Button from 'material-ui/Button'\nimport Card, { CardActions, CardHeader } from 'material-ui/Card'\nimport { LinearProgress } from 'material-ui/Progress'\nimport { withStyles } from 'material-ui/styles'\nimport Typography from 'material-ui/Typography'\nimport React from 'react'\n\nimport ResponsiveContentArea from '../../urb-base-webapp/components/ResponsiveContentArea'\n\nconst styles = theme => ({\n  card: {\n    minWidth: 275,\n  },\n})\n\nclass LogoutScreen extends React.Component<\n  {\n    classes: Object,\n  },\n  {\n    currentOperation: 'confirm' | 'logging out' | 'success' | 'failure',\n    errorMessage: string,\n  },\n> {\n  constructor( props: Object, context: Object ) {\n    super( props, context )\n\n    this.state = {\n      currentOperation: 'confirm',\n      errorMessage: '',\n    }\n  }\n\n  _handle_onClick_Logout = async() => {\n    this.setState({ currentOperation: 'logging out' })\n\n    try {\n      const loc = window.location\n      const host = loc.protocol + '//' + loc.hostname + ':' + loc.port\n\n      const response = await fetch( host + '/auth/logout', {\n        method: 'POST',\n        credentials: 'same-origin',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: '{}',\n      })\n\n      const responseData = await response.json()\n\n      console.log( 'LOGOUT USER RESPONSE' )\n      console.log( responseData )\n\n      if ( responseData.success ) {\n        // In case of success, notify user\n        this.setState({ currentOperation: 'success' })\n      } else {\n        // In case of error, tell user what the error is\n        this.setState({\n          currentOperation: 'failure',\n          errorMessage: responseData.error,\n        })\n      }\n    } catch ( err ) {\n      // In case response could not be received properly, tell the user\n      // In case of error, tell user what the error is\n      this.setState({\n        currentOperation: 'failure',\n        errorMessage:\n          'Did not receive proper response from server. Please try again. Message:' + err.message,\n      })\n    }\n  }\n\n  _handle_onClick_CancelLogout = () => {\n    this.setState({\n      currentOperation: 'failure',\n      errorMessage: 'User log out has been canceled',\n    })\n  }\n\n  _handle_onClick_TryAgain = () => {\n    this.setState({\n      currentOperation: 'confirm',\n      errorMessage: '',\n    })\n  }\n\n  _handle_onClick_Continue = () => {\n    window.location.replace( '/' )\n  }\n\n  renderCreating() {\n    const { classes } = this.props\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Creating user\" />\n        <Typography component=\"p\">Logging out. Please wait.</Typography>\n        <LinearProgress mode=\"query\" />\n        <CardActions>\n          <Button onClick={this._handle_onClick_CancelLogout}>Cancel</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  renderSuccess() {\n    const { classes } = this.props\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Logout\" />\n        <Typography component=\"p\">You have been logged out</Typography>\n        <CardActions>\n          <Button onClick={this._handle_onClick_Continue}>Continue</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  renderFailure() {\n    const { classes } = this.props\n    const { errorMessage } = this.state\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Creating user\" />\n        <Typography component=\"p\">\n          Failed logging out.\n          <br />\n          Reason: {errorMessage}\n        </Typography>\n        <CardActions>\n          <Button onClick={this._handle_onClick_TryAgain}>Try Again</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  renderPrompt() {\n    const { classes } = this.props\n\n    return (\n      <Card className={classes.card}>\n        <CardHeader title=\"Log Out\" />\n        <Typography component=\"p\">\n          You are currently logged in. Are you sure you want to log out?\n        </Typography>\n        <CardActions>\n          <Button onClick={this._handle_onClick_Logout}>Yes, Log Out</Button>\n        </CardActions>\n      </Card>\n    )\n  }\n\n  render() {\n    const { currentOperation } = this.state\n\n    return (\n      <ResponsiveContentArea>\n        {currentOperation === 'confirm' && this.renderPrompt()}\n        {currentOperation === 'logging out' && this.renderCreating()}\n        {currentOperation === 'success' && this.renderSuccess()}\n        {currentOperation === 'failure' && this.renderFailure()}\n      </ResponsiveContentArea>\n    )\n  }\n}\n\nexport default withStyles( styles )( LogoutScreen )\n"]}